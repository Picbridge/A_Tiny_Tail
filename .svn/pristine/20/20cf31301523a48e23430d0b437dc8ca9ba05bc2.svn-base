using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Tutorial_C_TutorialManager : MonoBehaviour {
    [SerializeField]
    private GameObject arrow;
    [SerializeField]
    private GameObject goalLine;
    [SerializeField]
    private GameObject catapultShooter;
    [SerializeField]
    private GameObject catapultButton;
    private float dt;
    private bool isGoingToShooter;
    private bool isGoingToButton;
    private bool isGoingToGoal;
    private bool isDivisible;
    Collider checkShooterCollider;
    Collider checkButtonCollider;

    // Use this for initialization
    void Start()
    {
        dt = 0;
        isGoingToShooter = false;
        isGoingToButton = false;
        isGoingToGoal = false;
        isDivisible = false;
        checkShooterCollider = catapultShooter.GetComponent<Collider>();
        checkButtonCollider = catapultButton.GetComponent<Collider>();
    }

    // Update is called once per frame
    void Update()
    {
        dt += Time.deltaTime;

        if (Input.GetKeyDown(KeyCode.Space) && isDivisible)
        {
            isDivisible = false;
        }

        if (isGoingToShooter == false && isGoingToButton == false && isGoingToGoal == false)
            arrow.transform.position = new Vector3(arrow.transform.position.x, (Mathf.Sin(dt * 4) * 0.5f + 2), arrow.transform.position.z);
        else if (isGoingToShooter == true)
            arrow.transform.position = new Vector3(catapultShooter.transform.position.x, (Mathf.Sin(dt * 4) * 0.5f + 2), catapultShooter.transform.position.z);
        else if (isGoingToButton == true)
            arrow.transform.position = new Vector3(catapultButton.transform.position.x, (Mathf.Sin(dt * 4) * 0.5f + 2), catapultButton.transform.position.z);
        else if (isGoingToGoal == true)
            arrow.transform.position = new Vector3(goalLine.transform.position.x, (Mathf.Sin(dt * 4) * 0.5f + 2), goalLine.transform.position.z);
    }

    private void OnTriggerEnter(Collider other)
    {
        if (other.tag == "Potion"&& !isDivisible)
        {
            isGoingToShooter = true;
            isDivisible = true;
        }
        else if (other == checkShooterCollider && isGoingToShooter && isDivisible == false)
        {
            isGoingToShooter = false;
            isGoingToButton = true;
        }
        else if (other == checkButtonCollider && isGoingToButton)
        {
            isGoingToButton = false;
            isGoingToGoal = true;
        }

    }
    private void OnTriggerExit(Collider other)
    {
         if (other == checkShooterCollider && isGoingToButton)
        {
            isGoingToButton = false;
            isGoingToGoal = true;
        }
    }
}
